{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
  "version": "0.2.0",
  "inputs": [
      {
          "id": "BLACKMAGIC",
          "type": "command",
          "command": "shellCommand.execute",
          "args": {
              "useSingleResult": true,
              "env": {
                  "PATH": "${workspaceFolder}${command:extension.commandvariable.envListSep}${env:PATH}"
              },
              "command": "${command:flipper-app-dev.fbtExecutable} -s get_blackmagic",
              "description": "Get Blackmagic device"
          }
      }
  ],
  "configurations": [
      {
          "name": "Attach FW (ST-Link)",
          "cwd": "${workspaceFolder}",
          "executable": "${command:flipper-app-dev.buildFolder}/f7-firmware-D/firmware.elf",
          "request": "attach",
          "type": "cortex-debug",
          "servertype": "openocd",
          "device": "stlink",
          "svdFile": "${command:flipper-app-dev.scriptsFolder}/debug/STM32WB55_CM4.svd",
          // If you're debugging early in the boot process, before OS scheduler is running,
          // you have to comment out the following line.
          "rtos": "FreeRTOS",
          "configFiles": [
              "interface/stlink.cfg",
              "${command:flipper-app-dev.scriptsFolder}/debug/stm32wbx.cfg"
          ],
          "postAttachCommands": [
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperversion.py",
              "fw-version",
              // "compare-sections",
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperapps.py",
              "fap-set-debug-elf-root ${command:flipper-app-dev.buildFolder}/f7-firmware-D/.extapps"
              // "source scripts/debug/FreeRTOS/FreeRTOS.py",
          ]
          // "showDevDebugOutput": "raw",
      },
      {
          "name": "Attach FW (blackmagic)",
          "cwd": "${workspaceFolder}",
          "executable": "${command:flipper-app-dev.buildFolder}/f7-firmware-D/firmware.elf",
          "request": "attach",
          "type": "cortex-debug",
          "servertype": "external",
          "gdbTarget": "${input:BLACKMAGIC}",
          "svdFile": "${command:flipper-app-dev.scriptsFolder}/debug/STM32WB55_CM4.svd",
          "rtos": "FreeRTOS",
          "postAttachCommands": [
              "monitor swdp_scan",
              "attach 1",
              "set confirm off",
              "set mem inaccessible-by-default off",
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperversion.py",
              "fw-version",
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperapps.py",
              "fap-set-debug-elf-root ${command:flipper-app-dev.buildFolder}/f7-firmware-D/.extapps"
              // "compare-sections",
          ]
          // "showDevDebugOutput": "raw",
      },
      {
          "name": "Attach FW (JLink)",
          "cwd": "${workspaceFolder}",
          "executable": "${command:flipper-app-dev.buildFolder}/f7-firmware-D/firmware.elf",
          "request": "attach",
          "type": "cortex-debug",
          "servertype": "jlink",
          "interface": "swd",
          "device": "STM32WB55RG",
          "svdFile": "${command:flipper-app-dev.scriptsFolder}/debug/STM32WB55_CM4.svd",
          "rtos": "FreeRTOS",
          "postAttachCommands": [
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperversion.py",
              "fw-version",
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperapps.py",
              "fap-set-debug-elf-root ${command:flipper-app-dev.buildFolder}/f7-firmware-D/.extapps"
          ]
          // "showDevDebugOutput": "raw",
      },
      {
          "name": "Attach FW (DAP)",
          "cwd": "${workspaceFolder}",
          "executable": "${command:flipper-app-dev.buildFolder}/f7-firmware-D/firmware.elf",
          "request": "attach",
          "type": "cortex-debug",
          "servertype": "openocd",
          "device": "cmsis-dap",
          "svdFile": "${command:flipper-app-dev.scriptsFolder}/debug/STM32WB55_CM4.svd",
          "rtos": "FreeRTOS",
          "configFiles": [
              "interface/cmsis-dap.cfg",
              "${command:flipper-app-dev.scriptsFolder}/debug/stm32wbx.cfg"
          ],
          "postAttachCommands": [
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperversion.py",
              "fw-version",
              "source ${command:flipper-app-dev.scriptsFolder}/debug/flipperapps.py",
              "fap-set-debug-elf-root ${command:flipper-app-dev.buildFolder}/f7-firmware-D/.extapps"
          ]
          // "showDevDebugOutput": "raw",
      }
  ]
}
